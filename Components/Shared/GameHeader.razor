@using MiniRisk.Models.Dtos
@using MiniRisk.Models.Enums

<div class="game-header">
    <span class="header-logo">ðŸŽ² MiniRisk</span>
    <span class="header-turn">Turno @GameState.TurnNumber</span>
    <span class="header-phase phase-@GameState.Phase.ToString().ToLower()">
        @GetPhaseLabel()
    </span>
    <span class="header-current-player"
          style="color: var(--player-@GetColorClass())">
        @(IsMyTurn ? "â–º TU TURNO" : $"Turno de: {GameState.CurrentPlayerName}")
    </span>
    <span class="header-actions">
        <button class="btn btn-secondary btn-small" title="ConfiguraciÃ³n">âš™</button>
    </span>
</div>

@code {
    [Parameter] public GameStateDto GameState { get; set; } = default!;
    [Parameter] public string MyPlayerId { get; set; } = string.Empty;

    private bool IsMyTurn => GameState.CurrentPlayerId == MyPlayerId;

    private string GetPhaseLabel() => GameState.Phase switch
    {
        GamePhase.Setup => "âš™ CONFIGURACIÃ“N",
        GamePhase.Reinforcement => "ðŸ›¡ï¸ REFUERZO",
        GamePhase.Attack => "âš”ï¸ ATAQUE",
        GamePhase.Fortification => "ðŸ° FORTIFICACIÃ“N",
        _ => GameState.Phase.ToString().ToUpper()
    };

    private string GetColorClass()
    {
        var player = GameState.Players
            .FirstOrDefault(p => p.PlayerId == GameState.CurrentPlayerId);
        return player?.Color.ToString().ToLower() ?? "neutral";
    }
}
