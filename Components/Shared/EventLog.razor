@using MiniRisk.Models.Dtos

<div class="event-log panel" @ref="_logContainer">
    <div class="panel-header">LOG DE EVENTOS</div>

    <div class="event-list">
        @foreach (var evt in Events)
        {
            <div class="event-entry event-@evt.Type.ToString().ToLower()">
                <span class="event-time">@evt.Timestamp.ToLocalTime().ToString("HH:mm")</span>
                <span class="event-icon">@GetEventIcon(evt.Type)</span>
                <span class="event-message">@evt.Message</span>
            </div>
        }
    </div>
</div>

@code {
    [Parameter] public List<GameEventDto> Events { get; set; } = [];

    private ElementReference _logContainer;

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        // Auto-scroll al final (serÃ­a ideal con JS, pero de momento bÃ¡sico)
    }

    private string GetEventIcon(MiniRisk.Models.Enums.GameEventType eventType) => eventType switch
    {
        GameEventType.GameStarted => "ðŸŽ®",
        GameEventType.TurnStarted => "ðŸ”„",
        GameEventType.ReinforcementsPlaced => "ðŸ›¡ï¸",
        GameEventType.AttackLaunched => "âš”ï¸",
        GameEventType.DiceRolled => "ðŸŽ²",
        GameEventType.TerritoryConquered => "ðŸ´",
        GameEventType.PlayerEliminated => "ðŸ’€",
        GameEventType.CardsTraded => "ðŸƒ",
        GameEventType.Fortified => "ðŸ°",
        GameEventType.TurnEnded => "â­ï¸",
        GameEventType.PlayerDisconnected => "âš ï¸",
        GameEventType.PlayerReconnected => "âœ…",
        GameEventType.GameOver => "ðŸ†",
        GameEventType.ChatMessage => "ðŸ’¬",
        _ => "ðŸ“Œ"
    };
}
